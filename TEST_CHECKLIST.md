# 功能测试检查清单

## ✅ 完成的配置

1. ✅ 迁移到阿里云 Supabase
2. ✅ 数据库结构创建完成
3. ✅ 权限配置已修复
4. ✅ 出库记录功能已验证

---

## 🧪 需要测试的功能模块

### 1. 📊 Dashboard（仪表盘）

**访问路径：** `/` 或 `/dashboard`

**测试项：**
- [ ] 页面能正常加载
- [ ] 统计数据显示正确
- [ ] 图表渲染正常
- [ ] 快速操作按钮可用

---

### 2. 📦 出库管理（OutboundManagement）

**访问路径：** `/outbound`

**测试项：**
- [x] 创建出库记录（已验证 ✅）
- [ ] 查看出库记录列表
- [ ] 出库记录详情查看
- [ ] 归还物资功能
- [ ] 库存自动扣减
- [ ] 设备位置自动更新

---

### 3. 🔧 安装向导（InstallWizard）

**访问路径：** `/install`

**测试项：**
- [ ] 安装步骤显示正常
- [ ] SOP 流程加载
- [ ] 步骤勾选功能
- [ ] 安装完成提交

---

### 4. 📋 审计日志（Audit）

**访问路径：** `/audit`

**测试项：**
- [ ] 审计记录列表加载
- [ ] 筛选功能
- [ ] 详情查看
- [ ] 时间排序

---

### 5. 🗄️ 数据库操作

**涉及的表：**

#### 核心业务表
- [ ] `locations` - 位置管理
- [ ] `assets` - 资产管理
- [ ] `outbound_records` - 出库记录（已验证 ✅）
- [ ] `inventory` - 库存管理
- [ ] `actions` - 操作记录

#### 基础数据表
- [ ] `printer_models` - 打印机型号
- [ ] `consumables` - 耗材
- [ ] `compatibilities` - 兼容性
- [ ] `codes` - 码管理
- [ ] `sim_cards` - SIM卡

#### 辅助表
- [ ] `audit_logs` - 审计日志
- [ ] `maintenance_records` - 维护记录
- [ ] `suppliers` - 供应商
- [ ] `price_history` - 价格历史
- [ ] `sops` - 标准操作流程

---

## 🔍 详细测试步骤

### 出库管理测试

1. **创建出库记录**
   - 访问 `/outbound`
   - 点击"新建出库"
   - 填写设备信息、目的地、操作员
   - 选择出库物资（相纸、墨水、配件等）
   - 提交记录
   - ✅ 验证：记录创建成功，库存自动扣减

2. **查看出库列表**
   - 出库记录显示在列表中
   - 状态显示为"出库中"
   - 可查看详细信息

3. **归还物资**
   - 点击"归还"按钮
   - 填写归还信息
   - 提交归还
   - ✅ 验证：状态变为"已归还"，库存恢复

---

### 资产管理测试

1. **添加位置**
   - 创建新位置（仓库/展厅/个人等）
   - ✅ 验证：`locations` 表有数据

2. **添加资产**
   - 添加打印机/路由器等设备
   - 指定位置和负责人
   - ✅ 验证：`assets` 表有数据

3. **资产操作**
   - 借用、归还、调拨
   - ✅ 验证：`actions` 表记录操作，资产位置更新

---

### 库存管理测试

1. **查看库存**
   - 相纸库存（按型号、尺寸）
   - 墨水库存（C/M/Y/K）
   - 配件库存（路由器、插板、线缆等）

2. **库存变动**
   - 出库时自动扣减
   - 归还时自动增加
   - ✅ 验证：`inventory` 表数据正确

---

### 审计日志测试

1. **查看日志**
   - 访问 `/audit`
   - 查看所有操作记录

2. **日志内容**
   - 操作类型（出库、归还、创建等）
   - 操作人
   - 时间戳
   - 详细信息

---

## 🚨 常见问题排查

### 问题 1：Permission denied

**解决方案：**
```sql
-- 执行权限修复脚本
-- 在 SQL Editor 运行 supabase/fix-permissions.sql
```

### 问题 2：表不存在

**解决方案：**
```sql
-- 检查表是否创建
SELECT table_name FROM information_schema.tables WHERE table_schema = 'public';

-- 如果缺表，重新执行迁移脚本
```

### 问题 3：数据无法保存

**检查项：**
1. 浏览器 Console 是否有错误
2. Network 标签查看请求状态
3. 检查 RLS 策略和权限
4. 验证字段名称是否匹配

---

## 📝 测试报告模板

测试日期：____________________

| 功能模块 | 测试项 | 状态 | 备注 |
|---------|-------|------|------|
| 出库管理 | 创建出库 | ✅ 通过 | |
| 出库管理 | 查看列表 | ⏳ 待测试 | |
| 出库管理 | 归还物资 | ⏳ 待测试 | |
| Dashboard | 数据加载 | ⏳ 待测试 | |
| 安装向导 | SOP流程 | ⏳ 待测试 | |
| 审计日志 | 记录查看 | ⏳ 待测试 | |

---

## ✅ 测试完成条件

- [ ] 所有页面能正常访问
- [ ] 所有表的增删改查功能正常
- [ ] 库存自动更新正确
- [ ] 审计日志记录完整
- [ ] 没有权限错误
- [ ] 没有 Console 错误

---

**当前进度：** 出库功能已验证 ✅，其他功能待测试
